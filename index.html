<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="referrer" content="no-referrer"/>
<meta name="referrer" content="never"/>
<meta name="referrer" content="same-origin"/>
<meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">





    <!-- ================= Favicon ================== -->
    <!-- Standard -->
		<link rel="shortcut icon" href="/favicon.ico">
    <!-- Styles -->
           <link href="assets/css/lib/bootstrap.min.css" rel="stylesheet">
           <link href="assets/css/style.css" rel="stylesheet">
           <link href="assets/css/lib/themify-icons.css" rel="stylesheet">
           <title>连扳股概念</title>
    <script>
    </script>
</head>

<body class="bg-primary">

    <div class="unix-login">
        <div class="container-fluid">
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="login-content">
                        <div class="login-logo">
                            <span style="color:#000000">连扳股概念</span>
                        </div>
                         <div class="card">
                             <div class="card-title" id="tou" style="margin-bottom:-5%">
                                 </div>

                                <div class="card-body">
                                    <div class="input-sizes">
                                        <form class="form-horizontal fc-view" >
                                                  
                                   <div class="form-group" >
                                             
                                           <div class="row">
                                              <div class="col-lg-2"></div>
                                                <div class="col-lg-8">
                                                    <select class="form-control" id="lian"  onchange="huoqu()">
																<option value="0">连扳高度选择</option>
																<option value="1">一板</option>
																<option value="2">二板</option>
																<option value="3">三板</option>
																<option value="4">四板</option>
																<option value="5">高度板</option>
													</select>
                                                    
                                                </div>
                                            </div>  
                                           <div class="row">
                                              <div class="col-lg-2"></div>
                                                <div class="col-lg-8">
                                                    <select class="form-control" id="gn"  style="margin-bottom:-3%" onchange="hq()">
																<option value="0">需【筛选概念】再下拉，默认不筛</option>
													</select>
                                                    
                                                </div>
                                            </div> 
                                           
                                   </div>
                                   
                                   <div class="form-group">
                                           <div class="row">
                                              <div class="col-lg-2"></div>
                                                <div class="col-lg-8">
                                                    <select class="form-control" id="guo"  style="margin-bottom:-3%" onchange="gai1()">
																<option value="0">国资/央背景</option>
													</select>
                                                    
                                                </div>
                                            </div>     
                                             </div> 
                                             
                                   <div class="form-group">
                                           <div class="row">
                                              <div class="col-lg-2"></div>
                                                <div class="col-lg-8">
                                                    <select class="form-control" id="suo"  style="margin-bottom:-3%" onchange="gai()">
																<option value="0">高度下所有股</option>
													</select>
                                                    
                                                </div>
                                            </div>     
                                             </div> 
                                   <div class="form-group" >                                            
                                           <div class="row">
                                              <div class="col-lg-2"></div>
                                                <div class="col-lg-8">
                                                    <select class="form-control" id="gainian"  style="margin-bottom:-3%">
																<option value="0">选择的股所属概念</option>
													</select>
                                                    
                                                </div>
                                            </div>  
                                        </div>
                                        
                                   <div class="form-group" >
                                            <div class="row">
                                              <div class="col-lg-2"></div>
                                                <div class="col-lg-8">
                                                    <input id="daima" type="text" placeholder="点这输股票名或代码获取相关概念" class="form-control"  name="example-input-small" lay-key="1" onblur="lsgc()" onclick="qingkong()">
                                                    
                                                </div>
               
                                            </div>                                   
                                            <div class="form-group">
                                            <div class="row">
                                              <div class="col-lg-2"></div>
                                                <div class="col-lg-8">
                                                    <input id="Time" lay-key="8" type="text" class="form-control" style="margin-bottom:-3%" onclick="qk()">
                                                </div>
                                            </div>
                                            
                                            </div>
                                                    

                                            <div class="row"align="right">
                                              
                                    </div>
                                        
                                        </form>
                                    </div>
                                </div>
                         </div>           
                    </div>
                </div>
            </div>
        </div>
    </div>
       <script src="assets/js/lib/jquery.min.js"></script>
    <script src="assets/laydate/laydate.js"></script>
    <script src="assets/layer_mobile/layer.js"></script>
    <script src="js/date.format.js"></script>
    <script src="js/gbk.js"></script>
   <script>
$(function(){
    laydate.render({
  elem: '#Time'
  ,type: 'datetime'

  ,zIndex: 99999999
  ,format: 'yyyy-MM-dd'
});


});   
   
   
   
   document.onkeydown = keyListener;
function keyListener(e) {
// 当按下回车键，执行我们的代码
    if (e.keyCode == 13) {
SubInfo();
    }
}

  function listSortBy(arr, field, order){
    var refer = [], result=[], order = order=='asc'?'asc':'desc', index;
    for(i=0; i<arr.length; i++){
        refer[i] = arr[i][field]+':'+i;
    }
        refer.sort(function (a,b) {
            a=parseFloat(a);
            b=parseFloat(b);
            if (a < b ) {    
                return -1;
            }
            if (a > b ) {
                return 1;
            }
            // a must be equal to b
            return 0;
        });


    if(order=='desc') refer.reverse();
    for(i=0;i<refer.length;i++){
        index = refer[i].split(':')[1];
        result[i] = arr[index];
    }
    return result;
}

function charu(soure, start, newStr){   
   return soure.slice(0, start) + newStr + soure.slice(start);
}
function qk(){
document.getElementById('Time').value="";   
}
	   
	   
function qingkong(){
  $("#guo").empty();
  $("#suo").empty();
  $("#gainian").empty();
  $("#gn").empty();
var obj3=document.getElementById('gn');  
var obj=document.getElementById('guo');
var obj1=document.getElementById('suo');
var obj2=document.getElementById('gainian');
obj.add(new Option("国资/央背景",0));
obj1.add(new Option("高度下所有股",0));
obj2.add(new Option("选择的股所属概念",0));
obj3.add(new Option("需要【筛选概念】再下拉，默认不筛",0));    
}
      function checkTime(i){
	if (i<10) 
  {i="0" + i}
  
  return i
 
};
function formatt(now){
              var   year=checkTime(now.getFullYear());   
          var   month=checkTime(now.getMonth()+1);   
          var   date=checkTime(now.getDate());   
          var   hour=checkTime(now.getHours());   
          var   minute=checkTime(now.getMinutes());   
          var   second=checkTime(now.getSeconds());   
          return  hour+":"+minute+":"+second;   
}

function hq(){
    document.getElementById('daima').value="";
    var obj=document.getElementById('lian');
    index=obj.selectedIndex;
    bid=obj.options[index].value;
    var gnobj=document.getElementById('gn');
    index=gnobj.selectedIndex;
    gnbid=gnobj.options[index].value;
    var shijian=$("#Time").val();
    if(shijian==""){
        var dizhi="https://apphq.longhuvip.com/w1/api/index.php?&Order=0&PhoneOSNew=2&PidType="+bid+"&Type=5&VerSion=5.4.0.3&a=DailyLimitPerformance&apiv=w29&c=HomeDingPan&st=1000"
    }
    else{
    shijian=shijian.slice(0,10);
    var dizhi="https://apphis.longhuvip.com/w1/api/index.php?Day="+shijian+"&Order=1&PhoneOSNew=2&PidType="+bid+"&Type=4&VerSion=5.4.0.3&a=DailyLimitPerformance&apiv=w29&c=HisHomeDingPan&st=1000"
    }
    console.log(shijian)     
                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:dizhi,
                dataType:'html',
                success:function(co){
                    xw=JSON.parse(co)
              $("#guo").empty();
              $("#suo").empty();
              $("#gainian").empty();
            var obj=document.getElementById('guo');
            var obj1=document.getElementById('suo');
            var obj2=document.getElementById('gainian');
            obj.add(new Option("国资/央背景",0));
            obj1.add(new Option("高度下所有股",0));
            obj2.add(new Option("选择的股所属概念",0));
                    for(var i=0;i<xw.info[0].length;i++){
                       obj1=document.getElementById('guo');
                       obj2=document.getElementById('suo');
                       obj3=document.getElementById('gainian');
                       shijian=new Date(xw.info[0][i][4]*1000);
                       shijian=formatt(shijian);     
                       mz=xw.info[0][i][0]+"【"+xw.info[0][i][1]+"】"+xw.info[0][i][5]+" "+shijian;
                       dm=xw.info[0][i][0];
                       if(gnbid!=0){
                       if(xw.info[0][i][5]==gnbid){obj2.add(new Option(mz,dm));}
                       }
                       else{obj2.add(new Option(mz,dm));}
                       g=0;
                   $.ajax({
                type:"post",//请求服务器载入数据
                async: false,
                url:"https://apparticle.longhuvip.com/w1/api/index.php?c=StockF10Basic&a=GetConceptw23&StockID="+xw.info[0][i][0]+"&State=1",
                dataType:'html',
                success:function(co1){
                    xw1=JSON.parse(co1)
                        
                    for(var j=0;j<xw1.List.length;j++){
                       mz1=xw1.List[j].CName;

                       if(mz1.indexOf("国")!=-1 || mz1.indexOf("央")!=-1 ){
                           g=1;
                       }
                       
                    }
                       if(gnbid!=0){
                       if(g==1 && gnbid==xw.info[0][i][5]){obj1.add(new Option(mz,dm));}
                       }
                       else{obj1.add(new Option(mz,dm));}                    

                }
                   })                       
                    } 

   
                }
                   })    
}



function huoqu(){
    document.getElementById('daima').value="";
    var obj=document.getElementById('lian');
    index=obj.selectedIndex;
    bid=obj.options[index].value;
    var shijian=$("#Time").val();
    if(shijian==""){
        var dizhi="https://apphq.longhuvip.com/w1/api/index.php?&Order=0&PhoneOSNew=2&PidType="+bid+"&Type=5&VerSion=5.4.0.3&a=DailyLimitPerformance&apiv=w29&c=HomeDingPan&st=1000"
    }
    else{
    shijian=shijian.slice(0,10);
    var dizhi="https://apphis.longhuvip.com/w1/api/index.php?Day="+shijian+"&Order=1&PhoneOSNew=2&PidType="+bid+"&Type=4&VerSion=5.4.0.3&a=DailyLimitPerformance&apiv=w29&c=HisHomeDingPan&st=1000"
    }
    console.log(shijian)    
    console.log(dizhi)
    var zbk=[];

    
                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:dizhi,
                dataType:'html',
                success:function(co){
                    xw=JSON.parse(co)
                    qingkong();      
                    for(var i=0;i<xw.info[0].length;i++){
                       obj1=document.getElementById('guo');
                       obj2=document.getElementById('suo');
                       obj3=document.getElementById('gainian');
                       shijian=new Date(xw.info[0][i][4]*1000);
                       shijian=formatt(shijian);     
                       mz=xw.info[0][i][0]+"【"+xw.info[0][i][1]+"】"+xw.info[0][i][5]+" "+shijian;
                       dm=xw.info[0][i][0];
                       obj2.add(new Option(mz,dm));
                       g=0;
                       zbk.push(xw.info[0][i][5])
                   $.ajax({
                type:"post",//请求服务器载入数据
                async: false,
                url:"https://apparticle.longhuvip.com/w1/api/index.php?c=StockF10Basic&a=GetConceptw23&StockID="+xw.info[0][i][0]+"&State=1",
                dataType:'html',
                success:function(co1){
                    xw1=JSON.parse(co1)
                        
                    for(var j=0;j<xw1.List.length;j++){
                       mz1=xw1.List[j].CName;

                       if(mz1.indexOf("国")!=-1 || mz1.indexOf("央")!=-1){
                           g=1;
                       }
                    }
                    if(g==1){
                        obj1.add(new Option(mz,dm));
                    }
                }
                   })                       
                    } 
    var obj4 = {}; 
      for(var i= 0, l = zbk.length; i< l; i++){ 
            var item = zbk[i]; 

            obj4[item]= (obj4[item] +1 ) || 1; 
    } 
    bk=Array.from(new Set(zbk));
    var bkk=[];
    for(var i=0;i<bk.length;i++){
      var ob=new Object();
      ob.name=bk[i];
      ob.value=parseFloat(obj4[ob.name]);
      bkk.push(ob);
    }
   bk=listSortBy(bkk,'value','desc'); 
   obj5=document.getElementById('gn');
      for(var i=0;i<bkk.length;i++){
          mz=bk[i]["name"]+"    【"+bk[i]["value"]+"个】"
          obj5.add(new Option(mz,bk[i]["name"]));
      }
   
                }
                   })
}    


function gai(){
        document.getElementById('daima').value="";
    var obj=document.getElementById('suo');
    index=obj.selectedIndex;
    bid=obj.options[index].value;
    var obj1=document.getElementById('guo');
    obj1.options[0].selected = true;    
                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:"https://apparticle.longhuvip.com/w1/api/index.php?c=StockF10Basic&a=GetConceptw23&StockID="+bid+"&State=1",
                dataType:'html',
                success:function(co){
                    xw=JSON.parse(co)
                  $("#gainian").empty();
                obj2=document.getElementById('gainian');
                    for(var j=0;j<xw.List.length;j++){
                       mz=xw.List[j].CName;
                       obj2.add(new Option(mz,0));

                       }
                    }                   

                   })
}    
function gai1(){
        document.getElementById('daima').value="";
    var obj=document.getElementById('guo');
    index=obj.selectedIndex;
    bid=obj.options[index].value;
    var obj1=document.getElementById('suo');
    obj1.options[0].selected = true; 
                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:"https://apparticle.longhuvip.com/w1/api/index.php?c=StockF10Basic&a=GetConceptw23&StockID="+bid+"&State=1",
                dataType:'html',
                success:function(co){
                    xw=JSON.parse(co)
                  $("#gainian").empty();
                obj2=document.getElementById('gainian');
                    for(var j=0;j<xw.List.length;j++){
                       mz=xw.List[j].CName;
                       obj2.add(new Option(mz,0));

                       }
                    }                   

                   })
} 

function lsgc(){
var daima="";
    var obj1=document.getElementById('lian');
    obj1.options[0].selected = true;    
if(isNaN($("#daima").val())==true){

    bianma=$URL.encode($("#daima").val());

                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:"https://q.stock.sohu.com/app1/stockSearch?method=search&type=all&keyword="+bianma+"&rt=jsonp",
                             dataType:'jsonp',//服务器返回json格式数据
                             jsonpCallback:'callback',
                             jsonp: 'callback',
                             crossDomain: true,
                             //data:"{}",
                             ContentType:'application/javascript',
                success:function(co){

                    if(co.result.length==0){alert("输入有误，重新输入")}
                    daima=co.result[0][1];
                    mama=co.result[0][2];
                    mama=mama.replace(/<[^>]+>/g,"");
document.getElementById('daima').value=mama+"【"+daima+"】";

                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:"https://apparticle.longhuvip.com/w1/api/index.php?c=StockF10Basic&a=GetConceptw23&StockID="+daima+"&State=1",
                dataType:'html',
                success:function(co){
                    xw=JSON.parse(co)
                  $("#gainian").empty();
                obj2=document.getElementById('gainian');
                    for(var j=0;j<xw.List.length;j++){
                       mz=xw.List[j].CName;
                       obj2.add(new Option(mz,0));

                       }
                    }                   

                   })
            
             },
         })

}    
else{ 
     daima=$("#daima").val();
                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:"https://np-anotice-stock.eastmoney.com/api/security/ann?page_size=50&page_index=1&ann_type=A&client_source=web&stock_list="+daima+"&f_node=0&s_node=0&rt=jsonp",
                             dataType:'jsonp',//服务器返回json格式数据
                             jsonpCallback:'cb',
                             jsonp: 'cb',
                             crossDomain: true,
                             //data:"{}",
                             //ContentType:'application/javascript',
                success:function(co){

                  

document.getElementById('daima').value=co.data.list[0].codes[0].short_name+"【"+daima+"】";
                   $.ajax({
                type:"get",//请求服务器载入数据
                //async: false,
                url:"https://apparticle.longhuvip.com/w1/api/index.php?c=StockF10Basic&a=GetConceptw23&StockID="+daima+"&State=1",
                dataType:'html',
                success:function(co){
                    xw=JSON.parse(co)
                  $("#gainian").empty();
                obj2=document.getElementById('gainian');
                    for(var j=0;j<xw.List.length;j++){
                       mz=xw.List[j].CName;
                       obj2.add(new Option(mz,0));

                       }
                    }                   

                   })
            
             },
         })
   
} 
}



   </script>
</body>
</html>
